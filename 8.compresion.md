# La transformada discreta del coseno

Esta sección presenta una familia de variantes de la transformada de Fourier discreta que tienen por dominio e imagen secuencias o vectores de números reales, y describe su uso e interés en el diseño de algoritmos de compresión para imágenes y grabaciones de sonido.

<!-- TODO: anticipar con un poco más de detalle lo que se va a hacer -->

## Archivos multimedia

Desde tiempos remotos, el ser humano ha tenido la necesidad de representar imágenes y sonidos a través de distintas técnicas como la pintura, la notación musical, la fotografía o la grabación de sonido. Con el desarrollo de los ordenadores digitales, que permiten administrar información en forma de secuencias finitas de dígitos binarios o **bits**, surgió una nueva forma de almacenar sonidos e imágenes: los archivos multimedia.

Para obtener un archivo multimedia que codifique una imagen o un sonido, el procedimiento habitual consiste en muestrear y cuantizar su señal analógica asociada, medida mediante un procedimiento mecánico o electromagnético. El muestreo consiste en medir un conjunto finito de valores relacionados con el fenómeno en cuestión: en caso de una imagen, se mide la intensidad de la luz en distintos puntos de la misma; en el sonido, la presión atmosférica en varios instantes. La cuantización asigna, para cada medida tomada, un valor en un conjunto finito, redondeando los valores medidos. De esta forma, estos fenómenos quedan registrados como un conjunto finito de dígitos que representan una versión aproximada de los mismos. Para recrear la imagen o el sonido se genera un fenómeno físico cuya señal analógica asociada se aproxime a la información digital almacenada, de forma que se genera una aproximación de la imagen o el sonido original.

En general el muestreo se produce a intervalos regulares: leyendo la presión atmosférica cada cierto tiempo en el caso del sonido o registrando las intensidades luminosas en los puntos de una rejilla sobre una imagen. El inverso de la longitud del intervalo temporal que separa muestras consecutivas se denomina **frecuencia de muestreo**, y la tupla de las dimensiones de la rejilla se llama **resolución**. La cuantización determina un subconjunto finito de números enteros que se pueden asignar a cada valor medido, y normalmente se elige el conjunto de números $\{0,\, 1,\, ...,\, 2^N - 1\}$ o el conjunto de números $\{-2^{N-1},\, -2^{N-1} + 1,\, ...,\, -1,\, 0,\, 1,\, ...,\, 2^N - 2\}$, con $N \in \mathbb N$, donde los valores son aproximadamente proporcionales a la intensidad medida (o a alguna transformación monótona de la misma, como la raíz cuadrada o el logaritmo). Ambos conjuntos tienen $2^N$ elementos, por lo que el valor de cada muestra se puede codificar con $N$ bits; en cuyo caso se denomina **profundidad de bits** al número $N$.

El formato de almacenamiento en bruto consiste en registrar el valor medido en cada muestra siguiendo algún orden canónico. Por ejemplo, dado un archivo de sonido en bruto, los primeros $N$ bits habitualmente representan la presión en el primer instante medido. Si un archivo contiene $M$ muestras medidas a una profundidad de bits de $N$, entonces el número de bits requeridos para almacenar el archivo es $N \cdot M$. De esta forma, según la frecuencia de muestreo (que es inversamente proporcional a $M$) o la resolución (el producto de sus dos valores es $M$) y según la profundidad de bits se tendrá un archivo de mayor o menor tamaño, que representará con menor o mayor fidelidad el fenómeno grabado. Sin embargo, la fidelidad es muy sensible a estos valores, por lo que en los archivos de sonido no es habitual que la frecuencia de muestreo sea inferior a $44100 Hz$ o que la profundidad de bits sea menor de $16$, y las imágenes fotográficas suelen tener una profundidad de bits de $24$ y una resolución cada vez mayor.

Los formatos de archivo multimedia más básicos almacenan entre otras cosas la frecuencia de muestreo y la profundidad de bits en el inicio del archivo, y a continuación los datos en bruto. Para la mayoría de aplicaciones, estos formatos no resultan prácticos, pues los archivos ocupan un espacio excesivo. Ante este problema surgió la necesidad de obtener algoritmos de compresión multimedia, con el que poder obtener archivos de tamaño más manejable.

Un primer intento de reducir el tamaño de los archivos consiste en aplicar algoritmos de compresión sin pérdida, que eliminan la redundancia de la información de los archivos, de forma que se puede reconstruir el archivo digital original. Entre estos métodos están los métodos estadísticos, que en lugar de almacenar los valores de cada muestra en un número fijo de bits intentan representar con menos bits los valores más comunes, y los métodos de diccionario, que almacenan en un diccionario secuencias de valores consecutivos comunes y, cuando estas aparecen, en lugar de reproducirlas escriben una referencia al diccionario. Sin embargo, estos métodos tienen un éxito discreto en los archivos de sonido y en las imágenes fotográficas, pues los valores medidos suelen seguir una distribución aproximadamente uniforme a lo largo de todo el rango de valores, y las ocurrencias de secuencias exactas de valores son poco frecuentes [@nelson1996data].

En contraposición a los algoritmos de compresión sin pérdida se tienen los algoritmos de compresión con pérdida, que codifican una versión aproximada del archivo digital en bruto. Un enfoque consiste en tratar la imagen o la grabación como una combinación lineal de ondas básicas y almacenar solo los coeficientes de las ondas que las componen que se consideren adecuadas para representar el contenido multimedia con suficiente fidelidad. Para ello, dado que la información que tiene el ordenador es la representación digital de la imagen o el sonido, se puede utilizar una operación semejante a la transformada de Fourier discreta que trabaje con tuplas de números de un conjunto ordenado y finito, como puede ser un subconjunto finito de los números reales.

## Transformada discreta del coseno

La transformada de Fourier discreta se puede ver como un caso particular de las transformaciones [@oppenheim1999discrete] $\mathcal A : \mathbb C^N \to \mathbb C^N$ definidas para cada $\{x\} = x_0,\,\dots,\,x_{N-1}$ como $\mathcal A\{x\} = X_0,\,\dots,\,X_{N-1}$ donde $$X_k = \sum_{n=0}^{N-1} x_n \phi^*_k(n) \quad \forall k \in \{0,\,\dots\,N-1\}$$ para algunas $\phi^*_k : \{0,\,\dots,\,N-1\} \to \mathbb C$ de forma que para cada $k \in \{0,\,\dots\,N - 1\}$ existe $\phi_k : \{0,\,\dots,\,N-1\} \to \mathbb C$ de forma que para cada $n,\,m$ se tenga que $$\frac 1 N \sum_{k=0}^{N-1} \phi_k(n) \phi^*_k(m) = \left\{ \begin{array}{ccc} 1 & \text{si} & m = n \\ 0 & \text{si} & m \neq n \end{array} \right.$$

Se observa que, si se llama $\Phi$ a la matriz que en la fila $k$ y la columna $n$ contiene el número $\phi_k(n)$ y $\Phi^*$ a la matriz que en la fila $k$ y la columna $n$ contiene el número $\phi^*_k(n)$, entonces las matrices tienen por filas las componentes de $\phi_k$ y $\phi^*_k$ respectivamente y la propiedad queda como que $\Phi \cdot (\Phi^*)^T = I_{N \times N}$ con $I_{N \times N}$ la matriz identidad. Esto equivale a que $\Phi^{-1} = (\Phi^*)^T$, y esto a que $\Phi^T \cdot \Phi^* = I_{N \times N}$, por lo que la propiedad puede reescribirse cambiando $\phi_k(n) \phi^*_k(m)$ por $\phi_n(k) \phi^*_m(k)$, de forma que expresa relaciones entre cada pareja de vectores $\phi_n$ y $\phi^*_m$. A los vectores $\phi_k$ y $\phi^*_k$ se les llamará **secuencias base**, y esta propiedad que se le exige a las secuencias base se llamará **relaciones de ortogonalidad** aunque no vaya necesariamente ligada a un producto escalar, cosa que ocurriría si se pudiese asociar $\phi^*_k(n)$ con $\phi_k(n)$ a través de una aplicación semilinal $\cdot ^* : \mathbb R \to \mathbb R$ con la cual $\displaystyle (x,\, y) \mapsto \frac 1 N \sum_{k=0}^{N-1} x_k y_k^*$ fuese una forma sesquilineal definida positiva.

Asumiendo que las secuencias base $\phi_k,\, \phi^*_k$ cumplen estas relaciones de ortogonalidad, se puede reconstruir $x_n$ como $$\frac 1 N \sum_{k=0}^{N-1} X_k \phi_k(n) = \frac 1 N \sum_{k=0}^{N-1} \left(\sum_{m=0}^{N-1} x_m \phi^*_k(m)\right) \phi_k(n)$$ $$= \sum_{k=0}^{N-1} \sum_{m=0}^{N-1} x_m \frac 1 N \phi^*_k(m) \phi_k(n) = \sum_{m=0}^{N-1} x_m \underbrace{\frac 1 N \sum_{k=0}^{N-1} \phi^*_k(m) \phi_k(n)}_{1 \text{ si } m = n,\ 0 \text{ si } m \neq n} = x_n$$

Obsérvese que el caso de la transformada de Fourier discreta es aquel en el que $\phi_k(n) = e^{\frac {2 \pi i k n} N}$ y $\phi^*_k(n) = e^{\frac {-2 \pi i k n} N}$, en cuyo caso $\phi^*_k(n)$ es el conjugado complejo de $\phi_k(n)$ y las relaciones de ortogonalidad son las determinadas por el producto escalar en $\mathbb C^N$.<!-- TODO: en la sección de la definición de la transformada de Fourier discreta estaría bien que estuviese probada esta ortogonalidad; y conviene que se compare con la del caso continuo --> En general, la información discreta que se almacena en cada muestra de una imagen o un sonido suele tomar un valor en un conjunto ordenado, que se puede interpretar como un subconjunto de $\mathbb R$. Por ello, dado que la transformada de Fourier discreta puede llevar secuencias de números reales en secuencias de números complejos, interesa buscar una transformada discreta dentro de las secuencias de números reales, $\mathcal R: \mathbb R^N \to \mathbb R^N$.

Para obtener una transformada de este tipo no basta tomar parte real en $\phi_k$ y $\phi^*_k$. En este caso, se obtiene $\phi_k(n) = \cos(\frac {2 \pi i k n} N)$ y $\phi_k^*(n) = \cos(\frac {-2 \pi i k n} N)$. Estas funciones no mantienen la relación de ortogonalidad, puesto que $\phi_k^*(n) = \phi_k^*(N - n)$ debido a la paridad y periodicidad del coseno, y por tanto si fuese cierto que $\frac 1 N \sum_{k=0}^{N-1} \phi_k(n) \phi^*_k(n) = 1$ para todo $n$ entonces también se tendría que $\frac 1 N \sum_{k=0}^{N-1} \phi_k(n) \phi^*_k(N - n) = 1$ para todo $n$, incluyendo aquellos tales que $n \neq N - n$.

En el estándar de imágenes JPEG y diversos estándares de archivos de sonido se usan distintas transformadas discretas, que se obtienen eligiendo distintas secuencias base $\phi_k,\, \phi^*_k$ formadas por números reales y que cumplan las relaciones de ortogonalidad.

<!-- TODO: presentar DCT-II y DCT-III. Relacionar con la DFT -->

<!-- TODO: explicar por qué son de especial interés en compresión de archivos -->

## Formato de imagen JPEG

TODO
<!-- TODO: presentar uso de las DCT-II y DCT-III. No se describen aquí porque son las más comunes, así que tiene sentido que vayan en la anterior subsección -->

## Compresión de archivos de sonido

TODO
<!-- TODO: presentar MDCT -->
<!-- TODO: describir el uso de la MDCT en compresión de sonido. Si es posible, indicar el especial interés de esta respecto de las DCT estándar -->
